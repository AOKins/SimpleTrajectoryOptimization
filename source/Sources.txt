http://cs.brown.edu/courses/cs195v/lecture/week11.pdf
https://stackoverflow.com/questions/12373940/difference-between-global-and-device-functions